# Skill Development Guide

このガイドは、Claude Code用のスキル（`.claude/skills/` 配下のカスタムコマンド）を開発する際のベストプラクティスをまとめたものです。

## 背景

スキル開発時に以下の問題が頻繁に発生していました：

- **descriptionの不明瞭さ**: 「何をするか」のみで「いつ使うか」が不明確
- **スキルの冗長性**: 自明なツールの使い方まで記載し、ファイルが肥大化
- **重複**: SKILL.mdとチェックリストで内容が重複

これらの問題を防ぐため、このガイドでは明確な基準とベストプラクティスを提供します。

## 1. descriptionの書き方

### 原則

**「いつ使うか」を必ず明記すること**

descriptionは、Claudeがスキルを選択する際の判断材料となります。「何をするか」だけでなく、「どのタイミングで使うべきか」を明確にすることで、適切な場面でスキルが呼び出されるようになります。

### 良い例 ✅

```yaml
description: |
  コミットやPR作成後に使用。linterでチェックできない設計・実装パターン
  （インターフェース設計、エラーハンドリング、テスト戦略等）をレビューして
  フィードバックを提供する。
```

**理由**: 「コミットやPR作成後に使用」と明記されており、いつ使うべきかが明確。

### 悪い例 ❌

```yaml
description: |
  コードの設計・実装パターンを品質チェックする。
```

**理由**: 何をするかは分かるが、いつ使うべきかが不明確。

### チェックリスト

description作成時には以下を確認：

- [ ] 「いつ使うか」が明記されている
- [ ] トリガー条件が具体的（例: 「コミット後」「PR作成後」「実装前」）
- [ ] 他のスキルとの使い分けが明確

## 2. SKILL.mdの簡潔性

### 原則

**役割と使い方のみを記載し、100行以内を目安とする**

SKILL.mdは「スキルの全体像を把握する」ためのドキュメントです。詳細な手順や項目は別ファイル（チェックリストやテンプレート）に分離します。

### 削除すべきもの

以下の内容はSKILL.mdから削除し、必要に応じて別ファイルに分離してください：

- **ツールの詳細な使い方**: パラメータの説明、コマンド例など
  - 例: `gh issue view 21 --json number,title,body` の詳細
  - Claudeはツールの使い方を既に知っているため、自明な説明は不要
- **自明な手順の説明**: 基本的なgit操作、ファイル読み込みなど
- **詳細なチェック項目**: レビュー観点、品質基準など
  - 別ファイル（例: `review-checklist.md`）に分離する

### 含めるべきもの

- スキルの目的と役割
- 使用するタイミング
- 大まかな手順（3〜5ステップ程度）
- 完了条件
- 注意点

### 例: 簡潔なSKILL.md

```markdown
# Quality Check Skill

## 目的

コミットやPR作成後に、linterでは検出できない設計・実装の問題を
レビューしてフィードバックを提供する。

## 使用タイミング

- コミット後（PRを作成する前）
- PR作成後（レビュー前の最終確認）

## 手順

1. 変更内容を確認
2. レビューチェックリストに基づいて評価
3. 問題点をリストアップ
4. フィードバックを提供

## 完了条件

- レビューが完了している
- 問題点が明確にリストアップされている

## 詳細

レビュー項目の詳細は `review-checklist.md` を参照。
```

### チェックリスト

SKILL.md作成時には以下を確認：

- [ ] 100行以内である
- [ ] ツールの自明な使い方を記載していない
- [ ] 詳細な項目は別ファイルに分離している
- [ ] 役割と使い方が明確に伝わる

## 3. 重複の防止

### 原則

**SKILL.mdとチェックリスト/テンプレートで役割を明確に分ける**

同じ内容を複数のファイルに記載すると、メンテナンスコストが増加し、内容の不整合が発生します。

### ファイルの役割分担

| ファイル | 役割 | 例 |
|---------|------|-----|
| **SKILL.md** | スキルの全体像 | 目的、タイミング、大まかな手順 |
| **チェックリスト** | 実行時の詳細項目 | レビュー観点、確認項目 |
| **テンプレート** | 成果物の雛形 | PR本文、レポート形式 |

### 良い例 ✅

**SKILL.md:**
```markdown
## 手順

1. 変更内容を確認
2. レビューチェックリストに基づいて評価
3. フィードバックを提供

レビュー項目の詳細は `review-checklist.md` を参照。
```

**review-checklist.md:**
```markdown
## レビュー項目

### インターフェース設計
- [ ] 適切な抽象化がされているか
- [ ] 依存関係が適切か
...
```

### 悪い例 ❌

**SKILL.md:**
```markdown
## レビュー項目

### インターフェース設計
- [ ] 適切な抽象化がされているか
- [ ] 依存関係が適切か
...
```

**review-checklist.md:**
```markdown
## レビュー項目

### インターフェース設計
- [ ] 適切な抽象化がされているか
- [ ] 依存関係が適切か
...
```

**理由**: 同じ内容が重複しており、更新時に不整合が発生するリスクがある。

### チェックリスト

- [ ] SKILL.mdと他ファイルで内容が重複していない
- [ ] 詳細項目は別ファイルに分離されている
- [ ] SKILL.mdから詳細ファイルへの参照がある

## 4. スキルの分割

### 原則

**1スキル = 1責務（単一責任の原則）**

複数の異なる責務が1つのスキルに混在すると、以下の問題が発生します：

- スキルが複雑になり、理解しづらくなる
- 再利用性が低下する
- テストやメンテナンスが困難になる

### 分割すべきケース

以下のような場合は、スキルを分割することを検討してください：

- **複数の独立した処理が含まれる**
  - 例: 「PRを作成して、レビューして、マージする」→ 3つのスキルに分割
- **条件分岐が多い**
  - 例: 「Issueの種類によって処理が大きく変わる」→ 種類ごとにスキルを分割
- **100行を大幅に超える**（300行以上など）
  - 内容を見直し、分割できる箇所を探す

### 例: 分割前 ❌

```yaml
name: manage-pr
description: |
  PRを作成し、CIを確認し、レビュー対応し、マージする。
```

**問題点**:
- 責務が多すぎる（作成、確認、対応、マージ）
- 「CIだけ確認したい」といったニーズに対応できない

### 例: 分割後 ✅

```yaml
name: create-pr
description: |
  作業ブランチの修正内容を把握し、PRを作成する。
  コード修正完了後にPRを作成する場合に使用。
```

```yaml
name: fix-pr
description: |
  PRのCI状態とレビューコメントを確認し、必要な修正と返信を行う。
  完了条件を満たした場合は自動的にマージする。
  PR作成後にCI失敗やレビューコメントへの対応が必要な場合に使用。
```

**改善点**:
- 各スキルが1つの責務のみを持つ
- 必要な処理だけを選んで実行できる
- descriptionで「いつ使うか」が明確

### チェックリスト

- [ ] 1つのスキルが1つの責務のみを持つ
- [ ] 複数の独立した処理が混在していない
- [ ] 他のスキルと組み合わせて使える設計になっている

## まとめ

スキル開発時には以下を意識してください：

1. **description**: 「いつ使うか」を必ず明記
2. **SKILL.md**: 役割と使い方のみ、100行以内を目安
3. **重複防止**: 詳細項目は別ファイルに分離
4. **分割**: 1スキル = 1責務を徹底

これらを守ることで、メンテナンス性が高く、再利用可能で、Claudeが適切に判断できるスキルを開発できます。

## 参考

- PR #20: managing-team、quality-checkスキルの実装
  - 実際に311行→101行の簡潔化を経験
  - descriptionとSKILL.mdの重複を複数回修正
